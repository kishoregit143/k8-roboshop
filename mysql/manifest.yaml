apiversion: v1
kind: configmap
metadata:
  name: mysql
  namespace: roboshop
data:
 my.conf:
  [mysqld]
  innodb_redo_log_capacity= 2G  

---
apiversion: app/v1
kind: Deployment
metadata:
 name: mysql
 namespace: roboshop
 #this labels are replecaset labels
 labels:
   project: toboshop
   component: mysql
   tier: db
spec:
 replicas: 1
 selector:
 # this lablels used to  select the pods
  matchlabels:
   project: toboshop
   component: mysql
   tier: db
   #pod defention
  templects:
    metadata:
      labels:
      project: toboshop
      component: mysql
      tier: db
    spec:
      containers:
      - name: mysql
        image: pullfrom dockerhub
        rednessProbe:
          tcpsocket:
            port: 3306
            initialdelayseconds: 10
            persionseconds: 10

        livenessProbe:
          tcpsocket:
            port: 3306
            initialdelayseconds: 20
            persionseconds: 20
        volumeMounts:
         - name: mysql-config
           mountpath: /etc/mysql/conf.d/my.conf
           subpath: my.conf    

---
apiversion: v1
kind: services
metadata:
   name: mysql
   namespace: mysql
spec:
 selector:
   project: toboshop
   component: mysql
   tier: db
   imagepullpolicy: always
ports:
    - protocol: tcp
      port: 3306 #services port
      targetport: 3306  #containers port

        